<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="robots" content="index,follow">
    <meta name="author" content="neo-project">
    <meta name="application-name" content="neo.org">
    <meta name="renderer" content="ie-stand">
    <title>测试和调用 CGAS</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Neo Documentation" />
    <meta property="og:description" content="Neo Documentation" />
    <meta property="og:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:title" content="Neo Documentation" />
    <meta name="twitter:description" content="Neo Documentation" />
    <meta name="twitter:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:card" content="summary_large_image" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/site.webmanifest">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link href="https://neo-cdn.azureedge.net/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://neo-cdn.azureedge.net/lib/animate.css/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
    <link href="/lib/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="/css/site.min.css" rel="stylesheet" />
</head>
<body data-spy="scroll" data-target="#navbar-sidenav">
    <nav class="navbar fixed-top navbar-expand-lg py-1 px-3 px-sm-4 px-md-5">
        <a class="navbar-brand" href="https://neo.org">
            <img class="logo" src="/img/logo.svg" alt="NEO Logo" />
            <img class="logo-dark" src="/img/logo-dark.svg" alt="NEO Logo" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/docs">Documentation</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/tutorial">Tutorial</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/faq">FAQ</a>
                </li>
                <li class="nav-item" style="margin-right: 100px">
                    <a class="nav-link" href="/articles">Articles</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link d-inline-block" href="javascript:" onclick="language('en-us')">EN</a>|<a class="nav-link d-inline-block" href="javascript:" onclick="language('zh-cn')">中文</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0 d-none">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>
    <div class="container-fluid" style="margin-top: 55px">
        <div class="row d-flex">
            <div class="d-none d-md-block catalog py-2 py-md-5 pl-md-3">
                
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO 介绍</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/1-introduction/1-Introduction_to_NEO.html'>简介</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/1-introduction/2-Cryptography_Blockchain_and_Smart_Contracts.html'>密码学、区块链和智能合约</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/1-introduction/3-Fundamentals_of_NEO.html'>基础知识</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/1-introduction/resource.html'>更多资源</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>钱包</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/2-wallet/1-Introduction_to_wallets.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/2-wallet/2-Key_derivation_and_address_generation_on_NEO.html'>私钥和地址生成</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/2-wallet/3-Key_encryption_and_contract_accounts.html'>私钥与合约账户</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/2-wallet/4-UTXO_and_account_models.html'>UTXO 与账户模型</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/2-wallet/resource.html'>更多资源</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>交易</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/3-transactions/1-Introduction_to_transactions.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/3-transactions/2-Structure_of_NEO_transactions.html'>交易结构</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/3-transactions/3-NEO_transaction_types.html'>交易类型</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/3-transactions/4-NEO_transaction_fees.html'>交易手续费</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/3-transactions/resource.html'>更多资源</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>区块</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/4-blocks/1-Introduction_to_blocks_and_blockchain.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/4-blocks/2-Structure_of_a_block.html'>区块结构</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/4-blocks/3-Block_creation_broadcasting.html'>区块创建与广播</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/4-blocks/4-Block_validation_processing.html'>区块验证</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/4-blocks/resource.html'>更多资源</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO 网络</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/5-network/1-Introduction_to_the_NEO_network_protocol.html'>协议和网络</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/5-network/resource.html'>更多资源</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>持久性</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/6-persistence/1-persistence.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/6-persistence/2-levelDB_data_structure.html'>LevelDB 数据结构</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>共识机制</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/7-consensus/1-Introduction_to_consensus.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/7-consensus/2-Proof_of_work_and_proof_of_stake.html'>PoW 与 PoS</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/7-consensus/3-PBFT_and_DBFT.html'>pBFT 与 dBFT</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/7-consensus/4-Examples_and_consensus_scenarios_for_dBFT.html'>共识示例与场景</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/7-consensus/resource.html'>更多资源</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>智能合约</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/What_is_smart_contract.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/Development_privateChain.html'>搭建私链</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/Development_set_up.html'>搭建开发环境</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/Development_compile.html'>编译、调用与部署</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/Smart_Contract_basics.html'>智能合约基础</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>创建 NEP-5 合约</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/What_is_nep5.html'>介绍</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/Implementation_of_NEP5.html'>实现 NEP-5</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/Give_an_ITO.html'>ITO</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/UTXO.html'>UTXO 基础</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>CGAS</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/1_what_is_cgas.html'>什么是 CGAS</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/2_global_asset_and_nep5.html'>全局资产与 NEP-5</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/3_utxo_model.html'>UTXO 模型</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/4_trigger.html'>触发器</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/5_minttokens_and_refund.html'>铸币与退款</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/6_signature_and_verification.html'>签名与验证</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/cgas/7_invocation.html'>交易调用</a>
</nav>
<a class='ml-0 my-1 nav-link' href='/tutorial/zh-cn/9-smartContract/neo_python_quickstart_cn.html'>NEO Python 快速入门</a>
</nav>
</nav>
            </div>
            <main class="p-3 p-sm-4 p-md-5">
                <a class="d-block d-md-none" href="javascript:" onclick="showCatalog()">Show / Hide Table of Contents</a>
                <h1 id='a4728d8c'><span class='with-space bd-content-title'>测试和调用 CGAS<a class='anchorjs-link ' href='#a4728d8c' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h1>
<p class='with-space'>本节课我们讲一下在 CGAS 发布后，如何对它进行测试和调用。</p>
<p class='with-space'>测试的主要技术就是通过 SDK 构造交易，然后发送到节点中，再查询执行结果。</p>
<h2 id='c47ebe6f'><span class='with-space bd-content-title'>构造交易<a class='anchorjs-link ' href='#c47ebe6f' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>首先调用智能合约的过程就是构造一笔 InvocationTransaction 的过程，一笔 InvocationTransaction 的数据结构如下：</p>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>字节数</th><th>字段</th><th>类型</th><th>描述</th></tr></thead>
<tbody><tr><td>1</td><td>Type</td><td>byte</td><td>交易类型</td></tr><tr><td>1</td><td>Version</td><td>byte</td><td>交易版本号，目前为 0 或 1</td></tr><tr><td>?</td><td>-</td><td>-</td><td>特定交易的数据</td></tr><tr><td>?*?</td><td>Attributes</td><td>tx_attr[]</td><td>该交易所具备的额外特性</td></tr><tr><td>34*?</td><td>Inputs</td><td>tx_in[]</td><td>输入</td></tr><tr><td>60 * ?</td><td>Outputs</td><td>tx_out[]</td><td>输出</td></tr><tr><td>?*?</td><td>Witnesses</td><td>Witness[]</td><td>用于验证该交易的脚本列表</td></tr><tr><td>?*?</td><td>Script</td><td>byte[]</td><td>包含该交易中智能合约的调用脚本</td></tr>
</tbody>
</table></figure>
<p class='with-space'>目前调用 CGAS 只能通过 SDK 来自行构造 InvocationTransaction，neo-gui，neo-cli 等客户端无法完美支持 CGAS（只支持 NEP-5 中的方法，不支持 CGAS 的 mintTokens，refund 等方法）。</p>
<p class='with-space'>具体的项目创建、引用 SDK，构造交易可以参考这个项目： <a href='https://github.com/neo-ngd/CGAS-Contract/blob/master/UnitTests' target='_blank'> CGAS UnitTests</a> 。</p>
<p class='with-space'>以 MintTokens 为例，下面对构造交易的代码进行讲解。</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='public static void MintTokens()
{
    var inputs = new List&lt;CoinReference&gt; {
        new CoinReference(){
            PrevHash = new UInt256(&quot;0xf5088ce508d86197c991ff0ef7651ddf01f3e555f257039c972082250e899210&quot;.Remove(0, 2).HexToBytes().Reverse().ToArray()),
            PrevIndex = 0
        }
    }.ToArray();
    //在 UTXO 模型中，一个交易输入必定是之前某个交易的交易输出，所以这里用两个字段表示一个交易输入。一个是引用的是之前某个交易的 TxId，也就是 PrevHash，另外一个是引用的交易输出在交易中的索引，索引从 0 开始。在上面的例子中，引用了 0xf5088ce508d86197c991ff0ef7651ddf01f3e555f257039c972082250e899210 这个交易的第 0 号交易输出作为当前这个交易的交易输入。

    var outputs = new List&lt;TransactionOutput&gt;{ new TransactionOutput()
    {
        AssetId = Blockchain.UtilityToken.Hash, //Asset Id, this is GAS
        ScriptHash = ScriptHash, //CGAS 地址
        Value = new Fixed8((long)(1 * (long)Math.Pow(10, 8)))
    }}.ToArray();
    //交易输出包含三个字段，资产 ID，收款方的 ScriptHash，以及转账金额。在 SDK 中，转账金额的单位是聪，所以这里填写 1 亿，代表通常所说的 1。

    Transaction tx = null;
    //声明一个 Transaction 对象

    using (ScriptBuilder sb = new ScriptBuilder())
    {
        sb.EmitAppCall(ScriptHash, &quot;mintTokens&quot;);
        sb.Emit(OpCode.THROWIFNOT);

        byte[] nonce = new byte[8];
        Random rand = new Random();
        rand.NextBytes(nonce);
        sb.Emit(OpCode.RET, nonce);
        tx = new InvocationTransaction
        {
            Version = 1,
            Script = sb.ToArray(),
            Outputs = outputs,
            Inputs = inputs,
            Attributes = new TransactionAttribute[0],
            Witnesses = new Witness[0]
        };
    }
    //这段代码参考自 neo 项目，https://github.com/neo-project/neo/blob/master/neo/Wallets/Wallet.cs#L282 照着写就好了

    var sign = new SignDelegate(SignWithWallet);
    sign.Invoke(tx, &quot;1.json&quot;, &quot;11111111&quot;);
    //打开钱包，使用该钱包对交易进行签名，需要注意的是，交易输入的 UTXO 是要在这个钱包里才可以，否则会签名失败

    Verify(tx);
    //验证交易
}'>Copy</button><pre><code class='csharp' lang='csharp'>public static void MintTokens()
{
    var inputs = new List&lt;CoinReference&gt; {
        new CoinReference(){
            PrevHash = new UInt256(&quot;0xf5088ce508d86197c991ff0ef7651ddf01f3e555f257039c972082250e899210&quot;.Remove(0, 2).HexToBytes().Reverse().ToArray()),
            PrevIndex = 0
        }
    }.ToArray();
    //在 UTXO 模型中，一个交易输入必定是之前某个交易的交易输出，所以这里用两个字段表示一个交易输入。一个是引用的是之前某个交易的 TxId，也就是 PrevHash，另外一个是引用的交易输出在交易中的索引，索引从 0 开始。在上面的例子中，引用了 0xf5088ce508d86197c991ff0ef7651ddf01f3e555f257039c972082250e899210 这个交易的第 0 号交易输出作为当前这个交易的交易输入。

    var outputs = new List&lt;TransactionOutput&gt;{ new TransactionOutput()
    {
        AssetId = Blockchain.UtilityToken.Hash, //Asset Id, this is GAS
        ScriptHash = ScriptHash, //CGAS 地址
        Value = new Fixed8((long)(1 * (long)Math.Pow(10, 8)))
    }}.ToArray();
    //交易输出包含三个字段，资产 ID，收款方的 ScriptHash，以及转账金额。在 SDK 中，转账金额的单位是聪，所以这里填写 1 亿，代表通常所说的 1。

    Transaction tx = null;
    //声明一个 Transaction 对象

    using (ScriptBuilder sb = new ScriptBuilder())
    {
        sb.EmitAppCall(ScriptHash, &quot;mintTokens&quot;);
        sb.Emit(OpCode.THROWIFNOT);

        byte[] nonce = new byte[8];
        Random rand = new Random();
        rand.NextBytes(nonce);
        sb.Emit(OpCode.RET, nonce);
        tx = new InvocationTransaction
        {
            Version = 1,
            Script = sb.ToArray(),
            Outputs = outputs,
            Inputs = inputs,
            Attributes = new TransactionAttribute[0],
            Witnesses = new Witness[0]
        };
    }
    //这段代码参考自 neo 项目，https://github.com/neo-project/neo/blob/master/neo/Wallets/Wallet.cs#L282 照着写就好了

    var sign = new SignDelegate(SignWithWallet);
    sign.Invoke(tx, &quot;1.json&quot;, &quot;11111111&quot;);
    //打开钱包，使用该钱包对交易进行签名，需要注意的是，交易输入的 UTXO 是要在这个钱包里才可以，否则会签名失败

    Verify(tx);
    //验证交易
}
</code></pre>
</figure>
<p class='with-space'>最开始是构造交易输入和交易输出，交易输入是来自自己的地址，交易输出是 CGAS 的地址。其中交易输入不可复用，每次测试都要使用未花费的交易输入。</p>
<p class='with-space'>交易输入包含以下两个字段：PrevHash，PrevIndex，分别表示所使用的交易输出的交易 ID 和索引。</p>
<p class='with-space'>这里要清楚一个概念，在 UTXO 模型中，所有的交易输入必定是之前某个交易的交易输出，这样形成了一个完成的链条。一个交易输出可以用一个“复合主键”来表示，就是交易 ID 和交易输出的索引。这就是交易输入的字段，它引用了一个交易输出的“主键”，而并非引用交易输出的完整数据。</p>
<p class='with-space'>然后开始构造一个 InvocationTransaction，最重要的就是里面的 Script 字段。这里通过 SDK 中的 ScriptBuilder 类进行创建。</p>
<p class='with-space'>交易构造完成后，对交易进行签名，签名的内容会写在交易的 Witness 字段中。</p>
<p class='with-space'>最后在本地进行交易验证，交易验证包括：</p>
<ol>
<li>
<p class='with-space'>交易的格式是否正确。</p></li>
<li>
<p class='with-space'>交易的大小是否超过限制（目前是 100KB）。</p></li>
<li>
<p class='with-space'>在一笔交易中是否使用了两个相同的 UTXO。</p></li>
<li>
<p class='with-space'>内存池中的交易是否包括该交易所使用的 UTXO。</p></li>
<li>
<p class='with-space'>是否双重花费（区块链中的的交易是否包括该交易所使用的 UTXO）。</p></li>
<li>
<p class='with-space'>交易中的资产是否过期，转账精度是否符合要求，资产是否存在。</p></li>
<li>
<p class='with-space'>交易中的输入和输出是否是平账的（GAS 除外）。</p></li>
<li>
<p class='with-space'>系统手续费是否合法。</p></li>
<li>
<p class='with-space'>如果交易是 MinerTransaction、 ClaimTransaction、IssueTransaction，是否满足 GAS 的规则。</p></li>
<li>
<p class='with-space'>交易属性是否合法。</p></li>
<li>
<p class='with-space'>交易的验证脚本是否通过（即执行 Trigger.Verify 部分的代码）。</p></li>
</ol>
<p class='with-space'>建议开发者要构造交易的时候要本地单步调试以便发现问题所在。</p>
<h2 id='bc466a1f'><span class='with-space bd-content-title'>安装 ApplicationLogs 插件<a class='anchorjs-link ' href='#bc466a1f' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>目前比较方便的查询交易结果的方式是要安装 ApplicationLogs 插件，其作为是在 RPC 模式下自动同步智能合约日志（ApplicationLogs），目前日志已经改为以 LevelDB 格式存储。</p>
<p class='with-space'>安装方法参考： <a href='https://docs.neo.org/zh-cn/node/plugin.html' target='_blank'> NEO 客户端插件</a> </p>
<p class='with-space'>需要说明的是，一定要先安装插件，再发送交易。</p>
<h2 id='f8c3369c'><span class='with-space bd-content-title'>发送交易，查询执行结果<a class='anchorjs-link ' href='#f8c3369c' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>如果交易验证无误，可以调用这个方法来输出交易的二进制数据</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='tx.ToArray().ToHexString();'>Copy</button><pre><code class='csharp' lang='csharp'>tx.ToArray().ToHexString();
</code></pre>
</figure>
<p class='with-space'>关于如何发送交易，请参考：</p>
<p class='with-space'> <a href='https://docs.neo.org/zh-cn/node/cli/latest-version/api.html#%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7' target='_blank'> neo-cli API 测试工具</a> </p>
<p class='with-space'> <a href='https://docs.neo.org/zh-cn/node/cli/latest-version/api/sendrawtransaction.html' target='_blank'> sendrawtransaction API</a> </p>
<p class='with-space'>查询交易执行结果，请参考：</p>
<p class='with-space'> <a href='https://docs.neo.org/zh-cn/node/plugin.html#getapplicationlog-%E6%96%B9%E6%B3%95' target='_blank'> getapplicationlog 方法</a> </p>
<p class='with-space'>执行结果包括：交易 ID，触发器，调用的合约 ScriptHash，虚拟机执行状态，GAS 花费，返回值以及通知。</p>
<p class='with-space'>下面是一个典型的执行结果：</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='{
    &quot;txid&quot;: &quot;0x48bd784d0ed6000cba64d0e303117e4c10081e3268afcf3b07e8b353a7594772&quot;,
    &quot;vmstate&quot;: &quot;HALT, BREAK&quot;,
    &quot;gas_consumed&quot;: &quot;4.648&quot;,
    &quot;stack&quot;: [],
    &quot;notifications&quot;: [{
        &quot;contract&quot;: &quot;0x74f2dc36a68fdc4682034178eb2220729231db76&quot;,
        &quot;state&quot;: {
            &quot;type&quot;: &quot;Array&quot;,
            &quot;value&quot;: [{
                &quot;type&quot;: &quot;ByteArray&quot;,
                &quot;value&quot;: &quot;7472616e73666572&quot;
            }, {
                &quot;type&quot;: &quot;ByteArray&quot;,
                &quot;value&quot;: &quot;&quot;
            }, {
                &quot;type&quot;: &quot;ByteArray&quot;,
                &quot;value&quot;: &quot;e8e3ce08268d16d867101feaf8c0ea130a923aba&quot;
            }, {
                &quot;type&quot;: &quot;Integer&quot;,
                &quot;value&quot;: &quot;1000000000&quot;
            }]
        }
    }]
}'>Copy</button><pre><code class='json' lang='json'>{
    &quot;txid&quot;: &quot;0x48bd784d0ed6000cba64d0e303117e4c10081e3268afcf3b07e8b353a7594772&quot;,
    &quot;vmstate&quot;: &quot;HALT, BREAK&quot;,
    &quot;gas_consumed&quot;: &quot;4.648&quot;,
    &quot;stack&quot;: [],
    &quot;notifications&quot;: [{
        &quot;contract&quot;: &quot;0x74f2dc36a68fdc4682034178eb2220729231db76&quot;,
        &quot;state&quot;: {
            &quot;type&quot;: &quot;Array&quot;,
            &quot;value&quot;: [{
                &quot;type&quot;: &quot;ByteArray&quot;,
                &quot;value&quot;: &quot;7472616e73666572&quot;
            }, {
                &quot;type&quot;: &quot;ByteArray&quot;,
                &quot;value&quot;: &quot;&quot;
            }, {
                &quot;type&quot;: &quot;ByteArray&quot;,
                &quot;value&quot;: &quot;e8e3ce08268d16d867101feaf8c0ea130a923aba&quot;
            }, {
                &quot;type&quot;: &quot;Integer&quot;,
                &quot;value&quot;: &quot;1000000000&quot;
            }]
        }
    }]
}
</code></pre>
</figure>
<p class='with-space'>vmstate：HALT, BREAK 表示执行成功，其它情况表示执行失败。</p>
<p class='with-space'>gas<em>consumed： 其中 gas</em>consumed 表示该交易消耗的 GAS 数量，即交易手续费。每笔交易会有10  GAS 的免费额度。如果数量小于 10，则不收取手续费，如果大于 10，那么收取超过 10 的那部分作为手续费并向上取整。例如 gas_consumed = 12.3，那么实际收取的手续费为 3 GAS。在测试中要注意手续费消耗，尽量控制在 10 以下。</p>
<p class='with-space'>其中通知部分如何转成可读的数据，参见 <a href='https://github.com/chenzhitong/ApplicationLogsTools' target='_blank'> ApplicationLogsTools</a> 项目。</p>
<h2 id='ffb541b2'><span class='with-space bd-content-title'>返回上节<a class='anchorjs-link ' href='#ffb541b2' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'> <a href='6_signature_and_verification.html'> 签名与验证</a> </p>
            </main>
            <div class="d-none d-lg-block side-nav py-2 py-md-5">
                <a href="https://github.com/neo-project/docs/blob/master/tutorial/zh-cn/9-smartContract\cgas\7_invocation.md" class="contribution-link d-block">Improve this Doc</a>
                <div class="side-nav-text">In this article</div>
                <div id="navbar-sidenav">
                    <nav class='nav nav-pills flex-column'>
<a class='ml--2 d-none my-1 nav-link' href='#a4728d8c'>测试和调用 CGAS</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-0 my-1 nav-link' href='#c47ebe6f'>构造交易</a>
<a class='ml-0 my-1 nav-link' href='#bc466a1f'>安装 ApplicationLogs 插件</a>
<a class='ml-0 my-1 nav-link' href='#f8c3369c'>发送交易，查询执行结果</a>
<a class='ml-0 my-1 nav-link' href='#ffb541b2'>返回上节</a>
</nav>
</nav>
                </div>
            </div>
        </div>
    </div>
    <div class="lightbulb" title="Turn On/Off" onclick="turnOff()">
        <i class="far fa-lightbulb"></i>
    </div>
    <footer>
        <div class="d-flex justify-content-between py-1 px-3 px-sm-4 px-md-5">
            <ul class="d-none d-md-block">
                <li><a href="https://github.com/neo-project/docs" title="GitHub" target="_blank">GitHub</a></li>
                <li><a href="https://github.com/neo-project/docs/issues" title="Issue" target="_blank">Issue</a></li>
                <li><a href="https://discord.io/neo" title="Discord" target="_blank">Discord</a></li>
            </ul>
            <p>Build by <a href="https://github.com/chenzhitong/NeoDocsBuilder" title="NeoDocsBuilder" target="_blank">NeoDocsBuilder</a></p>
            <p>Licensed under <a href="https://github.com/neo-project/docs/blob/master/LICENSE" title="CC-BY-4.0" target="_blank">CC-BY-4.0</a> license. </p>
        </div>
    </footer>
    <script src="https://neo-cdn.azureedge.net/lib/jquery/jquery.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/popper.js/popper.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/jquery.lazyload.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/text-autospace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130525731-2"></script>
    <script src="/js/site.min.js"></script>
    <script>
        //适用于FAQ的根据标题展开收缩
        if (false) {
            $("h2").click(function (e) {
                $(".div-collapse").not($(e.target).parents("h2").next()).hide("fast");
                $(e.target).parents("h2").next().toggle("fast");
            });
        }
    </script>
</body>
</html>
