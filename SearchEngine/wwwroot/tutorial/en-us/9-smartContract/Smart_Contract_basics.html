<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="robots" content="index,follow">
    <meta name="author" content="neo-project">
    <meta name="application-name" content="neo.org">
    <meta name="renderer" content="ie-stand">
    <title>NEO Smart contract 101</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Neo Documentation" />
    <meta property="og:description" content="Neo Documentation" />
    <meta property="og:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:title" content="Neo Documentation" />
    <meta name="twitter:description" content="Neo Documentation" />
    <meta name="twitter:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:card" content="summary_large_image" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/site.webmanifest">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link href="https://neo-cdn.azureedge.net/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://neo-cdn.azureedge.net/lib/animate.css/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
    <link href="/lib/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="/css/site.min.css" rel="stylesheet" />
</head>
<body data-spy="scroll" data-target="#navbar-sidenav">
    <nav class="navbar fixed-top navbar-expand-lg py-1 px-3 px-sm-4 px-md-5">
        <a class="navbar-brand" href="https://neo.org">
            <img class="logo" src="/img/logo.svg" alt="NEO Logo" />
            <img class="logo-dark" src="/img/logo-dark.svg" alt="NEO Logo" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/docs">Documentation</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/tutorial">Tutorial</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/faq">FAQ</a>
                </li>
                <li class="nav-item" style="margin-right: 100px">
                    <a class="nav-link" href="/articles">Articles</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link d-inline-block" href="javascript:" onclick="language('en-us')">EN</a>|<a class="nav-link d-inline-block" href="javascript:" onclick="language('zh-cn')">中文</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0 d-none">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>
    <div class="container-fluid" style="margin-top: 55px">
        <div class="row d-flex">
            <div class="d-none d-md-block catalog py-2 py-md-5 pl-md-3">
                
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Introduction to NEO</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/1-introduction/1-Introduction_to_NEO.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/1-introduction/2-Cryptography_Blockchain_and_Smart_Contracts.html'>Cryptography, Blockchain, and Smart Contracts</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/1-introduction/3-Fundamentals_of_NEO.html'>NEO Fundamentals</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/1-introduction/resource.html'>Additional Resources</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Wallet</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/2-wallet/1-Introduction_to_wallets.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/2-wallet/2-Key_derivation_and_address_generation_on_NEO.html'>Keys and Addresses</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/2-wallet/3-Key_encryption_and_contract_accounts.html'>Private key encryption and Wallet files</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/2-wallet/4-UTXO_and_account_models.html'>The UTXO and Account models</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/2-wallet/resource.html'>Additional Resources</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Transactions</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/3-transactions/1-Introduction_to_transactions.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/3-transactions/2-Structure_of_NEO_transactions.html'>Structure of NEO transactions</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/3-transactions/3-NEO_transaction_types.html'>NEO transaction types</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/3-transactions/4-NEO_transaction_fees.html'>Transaction fees</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/3-transactions/resource.html'>Additional Resources</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Blocks</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/4-blocks/1-Introduction_to_blocks_and_blockchain.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/4-blocks/2-Structure_of_a_block.html'>Structure of a Block</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/4-blocks/3-Block_creation_broadcasting.html'>Block Creation and Broadcasting</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/4-blocks/4-Block_validation_processing.html'>Block Validation and Processing</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/4-blocks/resource.html'>Additional Resources</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Network</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/5-network/1-Introduction_to_the_NEO_network_protocol.html'>NEO Network and Protocol</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/5-network/resource.html'>Additional Resources</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Persistence</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/6-persistence/1-persistence.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/6-persistence/2-levelDB_data_structure.html'>Developing a NEO Ping using Golang</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Consensus</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/7-consensus/1-Introduction_to_consensus.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/7-consensus/2-Proof_of_work_and_proof_of_stake.html'>PoW and PoS</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/7-consensus/3-PBFT_and_DBFT.html'>pBFT and dBFT</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/7-consensus/4-Examples_and_consensus_scenarios_for_dBFT.html'>dBFT Consensus Examples and Scenarios</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/7-consensus/resource.html'>Additional Resources</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Smart Contract</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/What_is_smart_contract.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/Development_privateChain.html'>Setting up a Private Chain</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/Development_set_up.html'>Setting up Development Enviroment</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/Development_compile.html'>Contract Invoking and Deployment</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/Smart_Contract_basics.html'>Smart Contract Basics</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Make your NEP-5 Token</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/What_is_nep5.html'>Introduction to NEP-5</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/Implementation_of_NEP5.html'>Implementation of NEP-5</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/Give_an_ITO.html'>ITO(Initial Token Offering)</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/UTXO.html'>UTXO basics</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>CGAS</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/1_what_is_cgas.html'>What is CGAS</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/2_global_asset_and_nep5.html'>Global asset and NEP-5</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/3_utxo_model.html'>UTXO model</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/4_trigger.html'>Trigger</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/5_minttokens_and_refund.html'>Mint and Refund</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/6_signature_and_verification.html'>Signature and Verification</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/cgas/7_invocation.html'>Transaction Invocation</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Write NEO smart contract with Python</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/neopython/part1_setup.html'>Installing and Setting up the Environment</a>
<a class='ml-0 my-1 nav-link' href='/tutorial/en-us/9-smartContract/neopython/part2_neopy.html'>Wallet Operations and Smart Contracts</a>
</nav>
</nav>
</nav>
            </div>
            <main class="p-3 p-sm-4 p-md-5">
                <a class="d-block d-md-none" href="javascript:" onclick="showCatalog()">Show / Hide Table of Contents</a>
                <figure><table class='table table-hover d-none'>
<thead>
<tr><th>layout</th><th>lang</th><th>lang-ref</th>
</tr>
</thead>
<tbody>
<tr><td>post</td><td>en</td><td>Smart_Contract_basics</td>
</tr>
</tbody>
</table></figure>
<h1 id='bb8d469d'><span class='with-space bd-content-title'>NEO Smart contract 101<a class='anchorjs-link ' href='#bb8d469d' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h1>
<blockquote class='bd-callout with-space'>
<p class='with-space'> <strong>Objective</strong> : Learn smart contract basic elements</p>
<p class='with-space'> <strong>Main points</strong> :</p>
<ol>
<li>
<p class='with-space'>The Strucutre of Smart contract</p></li>
<li>
<p class='with-space'>The Storage usage in Smart contract</p></li>
<li>
<p class='with-space'>Triggers and CheckWitness</p></li>
<li>
<p class='with-space'>Small contract Demos</p></li>
</ol>
</blockquote>
<p class='with-space'><p align="center">   <img width="60%" src="./imgs/newbie.jpg"> </p> In this tutorial, you will learn the basics of developing a smart contract</p>
<p class='with-space'>Let&#39;s have a look at our basic hello world contract.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='using Neo.SmartContract.Framework;
using Neo.SmartContract.Framework.Services.Neo;
using System;

namespace Helloworld
{
    public class Contract1 : SmartContract
    {
        private const string test_str = &quot;Hello World&quot;;
        public static String Main(string operation, object[] args)
        {
            Storage.Put(&quot;Hello&quot;, &quot;World&quot;);
            return test_str;
        }
    }
}'>Copy</button><pre><code class='c#' lang='c#'>using Neo.SmartContract.Framework;
using Neo.SmartContract.Framework.Services.Neo;
using System;

namespace Helloworld
{
    public class Contract1 : SmartContract
    {
        private const string test_str = &quot;Hello World&quot;;
        public static String Main(string operation, object[] args)
        {
            Storage.Put(&quot;Hello&quot;, &quot;World&quot;);
            return test_str;
        }
    }
}
</code></pre>
</figure>
<h2 id='e7000242'><span class='with-space bd-content-title'>Contract structure<a class='anchorjs-link ' href='#e7000242' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Every Smart Contract inherits the <code>SmartContract</code> base class which is in the NEO framework and provides some basic methods.</p>
<p class='with-space'>The <code>NEO</code> namespace is the API provided by the Neo blockchain, providing a way to access the block-chain data and manipulate the persistent store. These APIs are divided into two categories:</p>
<ol>
<li>
<p class='with-space'>Blockchain ledger. The contract can access all the data on the entire blockchain through interops layer, including complete blocks and transactions, as well as each of their fields.</p></li>
<li>
<p class='with-space'>Persistent store. Each application contract deployed on NEO has a storage space that can only be accessed by the contract itself. These methods provided can access the data in the contract.</p></li>
</ol>
<h2 id='e8769108'><span class='with-space bd-content-title'>Constract property<a class='anchorjs-link ' href='#e8769108' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Inside the contract class, the property defined with <code>static readonly</code> or <code>const</code> is the contract property which can be used as constants and can not be changed. For instance, when we want to define a Owner of that contract or the factor number which will be used in the later asset transfer, we can define these constants in this way:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='// Represents onwner of this contract, which is a fixed address. Usually should be the contract creator
public static readonly byte[] Owner = &quot;ATrzHaicmhRj15C3Vv6e6gLfLqhSD2PtTr&quot;.ToScriptHash();

// A constant number
private const ulong factor = 100000000;'>Copy</button><pre><code class='csharp' lang='csharp'>// Represents onwner of this contract, which is a fixed address. Usually should be the contract creator
public static readonly byte[] Owner = &quot;ATrzHaicmhRj15C3Vv6e6gLfLqhSD2PtTr&quot;.ToScriptHash();

// A constant number
private const ulong factor = 100000000;
</code></pre>
</figure>
<p class='with-space'>These properties defined in contract property are usually constants that can be used inside the methods of smart contract and every time the smart contract is running on any instance, these properties keep the same value.</p>
<p class='with-space'>In addition, developer can define static method  in contract and return a constant, which is exposing the method  out of the contract and let end-user can call the method to get the fixed value when they try to query the smart contract. For instance, when you create you own token, you have to define a name which you may want everyone use you contract can check he name with this method.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='public  static  string  Name() =&gt;  &quot;name of the token&quot;;'>Copy</button><pre><code class='csharp' lang='csharp'>public  static  string  Name() =&gt;  &quot;name of the token&quot;;
</code></pre>
</figure>
<h2 id='cc6f7dc0'><span class='with-space bd-content-title'>Storage property<a class='anchorjs-link ' href='#cc6f7dc0' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>When you develop the smart contract, you have to store your application data on the blockchain. When a Smart Contract is created or when a transaction awakens it, the Contract’s code can read and write to its storage space. All data stored in the storage of the smart contract are automatically persisted between invocations of the smart contract. Full nodes in the blockchain store the state of every smart contract on the chain.</p>
<p class='with-space'>NEO has provided data access interface based on key-value pairs. Data records may be read or deleted from or written to the smart contracts using keys. Besides, smart contracts may retrieve and send their storage contexts to other contracts, thereby entrusting other contracts to manage their storage areas. In C# development, smart contract can use the <code>Storage</code> Class to read/write the persistent storage  The <code>Storage</code> class is a static class and does not require a constructor. The methods of <code>Storage</code> class can be viewed in this <a href='https://docs.neo.org/en-us/sc/reference/fw/dotnet/neo/Storage.html' target='_blank'> API References</a> </p>
<p class='with-space'>For instance, if you want to store the total supply of your token into storage:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='// Key is totalSupply and value is 100000000
Storage.Put(Storage.CurrentContext, &quot;totalSupply&quot;, 100000000);'>Copy</button><pre><code class='csharp' lang='csharp'>// Key is totalSupply and value is 100000000
Storage.Put(Storage.CurrentContext, &quot;totalSupply&quot;, 100000000);
</code></pre>
</figure>
<p class='with-space'>Here <code>CurrentContext</code> Returns the current store context. After obtaining the store context, the object can be passed as an argument to other contracts (as a way of authorization), allowing other contracts to perform read/write operations on the persistent store of the current contract.</p>
<p class='with-space'> <code>Storage</code> work well for storing primitive values and while you can use an <code>StorageMap</code> which can be used for storing structured data, this will store the entire container in a single key in smart contract storage.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='//Get the totalSupply in the storageMap. The Map is used an entire container with key name &quot;contract&quot;
StorageMap contract = Storage.CurrentContext.CreateMap(nameof(contract));
return contract.Get(&quot;totalSupply&quot;).AsBigInteger();'>Copy</button><pre><code class='csharp' lang='csharp'>//Get the totalSupply in the storageMap. The Map is used an entire container with key name &quot;contract&quot;
StorageMap contract = Storage.CurrentContext.CreateMap(nameof(contract));
return contract.Get(&quot;totalSupply&quot;).AsBigInteger();
</code></pre>
</figure>
<h2 id='d73695be'><span class='with-space bd-content-title'>Data type<a class='anchorjs-link ' href='#d73695be' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>When using C# to develop smart contracts, you cannot use the full set of C# features due to the difference between NeoVM and Dotnet IL.</p>
<p class='with-space'>Because NeoVM is more compact, we can only compile limited C# / dotnet features into an AVM file.</p>
<p class='with-space'>NeoVM provides the following basic types：</p>
<ul class='with-space'>
<li>
<p class='with-space'> <code>ByteArray</code> </p></li>
<li>
<p class='with-space'> <code>Integer</code> </p></li>
<li>
<p class='with-space'> <code>Boolean</code> </p></li>
<li>
<p class='with-space'> <code>Array</code> </p></li>
<li>
<p class='with-space'> <code>Struct</code> </p></li>
<li>
<p class='with-space'> <code>Map</code> </p></li>
<li>
<p class='with-space'> <code>Interface</code> </p></li>
</ul>
<p class='with-space'>The basic types that can be directly generated from AVM code are only：</p>
<ul class='with-space'>
<li>
<p class='with-space'> <code>ByteArray</code> （Both Integer and Boolean are represented by ByteArray）</p></li>
<li>
<p class='with-space'> <code>Array</code> </p></li>
<li>
<p class='with-space'> <code>Struct</code> </p></li>
<li>
<p class='with-space'> <code>Map</code> </p></li>
</ul>
<p class='with-space'>The basic types of C# are:</p>
<ul class='with-space'>
<li>
<p class='with-space'> <code>Int8 int16 int32 int64 uint8 uint16 uint32 uint64</code> </p></li>
<li>
<p class='with-space'> <code>float double</code> </p></li>
<li>
<p class='with-space'> <code>Boolean</code> </p></li>
<li>
<p class='with-space'> <code>Char String</code> </p></li>
</ul>
<h2 id='cc473b59'><span class='with-space bd-content-title'>Your first NEO contract<a class='anchorjs-link ' href='#cc473b59' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>After analysing the basic hello world contract, let us move to your first real-world smart contract. Here we provide a very simple DNS system which was written in C#. The main function of the DNS is store the domain for users. It contains all the points above except the events. We can investigate this smart contract to learn how to make a basic smart contract. The source code is here:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='using Neo.SmartContract.Framework;
using Neo.SmartContract.Framework.Services.Neo;
namespace Neo.SmartContract
{
    public class Domain : SmartContract
    {
        public static object Main(string operation, params object[] args)
        {
            if (Runtime.Trigger == TriggerType.Application){
                    switch (operation){
                        case &quot;query&quot;:
                            return Query((string)args[0]);
                        case &quot;register&quot;:
                            return Register((string)args[0], (byte[])args[1]);
                        case &quot;delete&quot;:
                            return Delete((string)args[0]);
                        default:
                            return false;
                    }
            }
        }

        private static byte[] Query(string domain)
        {
            return Storage.Get(Storage.CurrentContext, domain);
        }


        private static bool Register(string domain, byte[] owner)
        {
            // Check if  the owner is the same as the one who invoke the contract
            if (!Runtime.CheckWitness(owner)) return false;
            byte[] value = Storage.Get(Storage.CurrentContext, domain);
            if (value != null) return false;
            Storage.Put(Storage.CurrentContext, domain, owner);
            return true;
        }

        private static bool Delete(string domain)
        {
            // To do
        }
    }
}'>Copy</button><pre><code class='csharp' lang='csharp'>using Neo.SmartContract.Framework;
using Neo.SmartContract.Framework.Services.Neo;
namespace Neo.SmartContract
{
    public class Domain : SmartContract
    {
        public static object Main(string operation, params object[] args)
        {
            if (Runtime.Trigger == TriggerType.Application){
                    switch (operation){
                        case &quot;query&quot;:
                            return Query((string)args[0]);
                        case &quot;register&quot;:
                            return Register((string)args[0], (byte[])args[1]);
                        case &quot;delete&quot;:
                            return Delete((string)args[0]);
                        default:
                            return false;
                    }
            }
        }

        private static byte[] Query(string domain)
        {
            return Storage.Get(Storage.CurrentContext, domain);
        }


        private static bool Register(string domain, byte[] owner)
        {
            // Check if  the owner is the same as the one who invoke the contract
            if (!Runtime.CheckWitness(owner)) return false;
            byte[] value = Storage.Get(Storage.CurrentContext, domain);
            if (value != null) return false;
            Storage.Put(Storage.CurrentContext, domain, owner);
            return true;
        }

        private static bool Delete(string domain)
        {
            // To do
        }
    }
}
</code></pre>
</figure>
<p class='with-space'>Let&#39;s slice it and learn it step by step.</p>
<h2 id='d1890376'><span class='with-space bd-content-title'>Main method<a class='anchorjs-link ' href='#d1890376' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Theoretically, smart contracts can have any entry points, but we recommend you use the main function as the entry point of smart contracts for easier invocation. In the main function, user can call other function according to the different entry point calling. Usually in the main method, developer has to handle the <code>trigger</code> .</p>
<h3 id='d7a7dc09'><span class='with-space bd-content-title'>Trigger<a class='anchorjs-link ' href='#d7a7dc09' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>A smart contract trigger is a mechanism that triggers the execution of smart contracts. There are four triggers introduced in the NEO smart contract，the most used are <code>Verification</code> and <code>Application</code> .</p>
<h3 id='efc9fc03'><span class='with-space bd-content-title'>Verification trigger<a class='anchorjs-link ' href='#efc9fc03' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>A Verification trigger is used to call the contract as a verification function, which can accept multiple parameters and should return a valid Boolean value, indicating the validity of the transaction or block.</p>
<p class='with-space'>When you transfer assets from account A to account B, a verification contract is triggered. All the nodes that received the transaction (including normal nodes and blue consensus nodes) verify account A&#39;s contract. If the return value is true, the transfer is completed successfully. If false is returned, the transfer is failed.</p>
<p class='with-space'>Therefore, the verification trigger determines whether the transaction will be relayed to the rest of the network. If return <code>false</code> , that means the transaction will not be recorded in the blockchain and the transaction failed.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='public static bool Main(byte[] signature)
{
    if (Runtime.Trigger == TriggerType.Verification)
    {
        if (/*condition A*/)
                return true;
            else
                return false;
    }  
}'>Copy</button><pre><code class='csharp' lang='csharp'>public static bool Main(byte[] signature)
{
    if (Runtime.Trigger == TriggerType.Verification)
    {
        if (/*condition A*/)
                return true;
            else
                return false;
    }  
}
</code></pre>
</figure>
<h3 id='ee1a28a3'><span class='with-space bd-content-title'>Application trigger<a class='anchorjs-link ' href='#ee1a28a3' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>An application trigger is used to invoke the contract as a verification function, which can accept multiple parameters, change the blockchain status, and return values of any type.</p>
<p class='with-space'>Unlike the verification trigger which is triggered by a transfer, an application trigger is triggered by a special transaction <code>InvocationTransaction</code> . If the application (Web/App) calls a smart contract, an <code>InvocationTransaction</code> is constructed, and then signed and broadcast in the blockchain. An application trigger is used to invoke the contract as a verification function, which can accept multiple parameters, change the blockchain status, and return values of any type. After the <code>InvocationTransaction</code> transaction is confirmed, the smart contract is executed by the consensus node. The common node does not execute the smart contract when forwarding the transaction.</p>
<p class='with-space'>Since the application contract is executed after <code>InvocationTransaction</code> is confirmed, the transaction is recorded in the blockchain no matter the execution of the application contract is successful or not.</p>
<p class='with-space'>The success and failure of InvocationTransaction is not necessarily related to the success or failure of execution of smart contracts.</p>
<p class='with-space'>Usually in a smart contract, both verification trigger and application trigger can be caught and developer have to handle the trigger.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='public static Object Main(string operation, params object[] args)
{
    if (Runtime.Trigger == TriggerType.Verification)
    {
        if (/*Condition A*/)
                return true;
            else
                return false;
    }  
    if (Runtime.Trigger == TriggerType.Application)
    {
        if (operation == &quot;FunctionA&quot;) return FunctionA(args);
    }  
}

// There is a smart contract entry point and redirected from main method
public static bool FunctionA(params object[] args)
{
    //some code  
}'>Copy</button><pre><code class='csharp' lang='csharp'>public static Object Main(string operation, params object[] args)
{
    if (Runtime.Trigger == TriggerType.Verification)
    {
        if (/*Condition A*/)
                return true;
            else
                return false;
    }  
    if (Runtime.Trigger == TriggerType.Application)
    {
        if (operation == &quot;FunctionA&quot;) return FunctionA(args);
    }  
}

// There is a smart contract entry point and redirected from main method
public static bool FunctionA(params object[] args)
{
    //some code  
}
</code></pre>
</figure>
<p class='with-space'>In our <code>DNS smart contract</code> , the first function is the <code>main</code> function which is the main entry of the smart contract. The main function reads the first argument as operation and the remaining as other arguments.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='public static object Main(string operation, params object[] args){
    if (Runtime.Trigger == TriggerType.Application){
        switch (operation){
        case &quot;query&quot;:
                 return Query((string)args[0]);
        case &quot;register&quot;:
                return Register((string)args[0], (byte[])args[1]);
        case &quot;delete&quot;:
                return Delete((string)args[0]);re
        default:
                return false;
        }
    }
}'>Copy</button><pre><code class='csharp' lang='csharp'>public static object Main(string operation, params object[] args){
    if (Runtime.Trigger == TriggerType.Application){
        switch (operation){
        case &quot;query&quot;:
                 return Query((string)args[0]);
        case &quot;register&quot;:
                return Register((string)args[0], (byte[])args[1]);
        case &quot;delete&quot;:
                return Delete((string)args[0]);re
        default:
                return false;
        }
    }
}
</code></pre>
</figure>
<p class='with-space'>Inside the main function, we first use the Trigger to judge whether user invoke smart contract with <code>invocationTransaction</code> , which means user calls the smart contract application. Here because it is a normal smart contract without asset transfer, therefore, the only trigger need to be considered is the Application Trigger. In side of the judgement statement, the function will redirect other function depends on the operation type.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='if (Runtime.Trigger == TriggerType.Application)'>Copy</button><pre><code class='csharp' lang='csharp'>if (Runtime.Trigger == TriggerType.Application)
</code></pre>
</figure>
<p class='with-space'>Now we can see what happend in each detailed function. The first one is the Query function, which query the owner of the domain address. Here we use the <code>Storage.Get</code> method, and the first argument is context, and here we pass the CurrentContext. The second parameter is the key of the storing key-value pair. Here we use the domain.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='private static byte[] Query(string domain){
    return Storage.Get(Storage.CurrentContext, domain);
}'>Copy</button><pre><code class='csharp' lang='csharp'>private static byte[] Query(string domain){
    return Storage.Get(Storage.CurrentContext, domain);
}
</code></pre>
</figure>
<h2 id='eb6c173f'><span class='with-space bd-content-title'>CheckWitness<a class='anchorjs-link ' href='#eb6c173f' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>In many, if not all cases, you will probably be wanting to validate whether the address invoking your contract code is really who they say they are.</p>
<p class='with-space'><p align="center">   <img width="60%"  src="./imgs/check.jpg" />  </p></p>
<p class='with-space'>The <code>Runtime.CheckWitness</code> method accepts a single parameter which represents the address that you would like to validate against the address used to invoke the contract code. In more deeper detail, it verifies that the transactions / block of the calling contract has validated the required script hashes.</p>
<p class='with-space'>Usually this method is used to check whether an specified address is the the contract caller,  and then the address can be used to do store change or something else.</p>
<p class='with-space'>Inside our <code>DNS smart contract</code> , the <code>Register</code> function is firstly check if the owner is the same as the one who invoke the contract. Here we use the <code>Runtime.CheckWitness</code> function. Then we try to fetch the domain owner first to see if the domain is already exists in the storage. If not, we can store our domain-&gt;owner pair using the <code>Storage.Put</code> method.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='private static bool Register(string domain, byte[] owner){
     if (!Runtime.CheckWitness(owner))
        return false;
     byte[] value = Storage.Get(Storage.CurrentContext, domain);
     if (value != null)
        return false;
     Storage.Put(Storage.CurrentContext, domain, owner);
     return true;
 }'>Copy</button><pre><code class='csharp' lang='csharp'>private static bool Register(string domain, byte[] owner){
     if (!Runtime.CheckWitness(owner))
        return false;
     byte[] value = Storage.Get(Storage.CurrentContext, domain);
     if (value != null)
        return false;
     Storage.Put(Storage.CurrentContext, domain, owner);
     return true;
 }
</code></pre>
</figure>
<p class='with-space'>Similar to the Register method, the Delete function check the owner first and if it exists and it is the same as the one who invoke the contract, delete the pair using the <code>Storage.Delete</code> method.  This method is leaving as a question in the end of this part.</p>
<h2 id='c97533b6'><span class='with-space bd-content-title'>Events<a class='anchorjs-link ' href='#c97533b6' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>In Smart contract, events are a way  to communicate that something happened on the blockchain to your app front-end (or back-end), which can be &#39;listening&#39; for certain events and take action when they happen. You might use this to update an external database, do analytics, or update a UI. In some specified contract standard,  it defined some events should be posted. It is not cover in this page, but is very useful for the other smart contracts. For instance, in the NEP-5 Token, the events <code>transfer</code> should be fired when user invoke the transfer function.</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='//Should be called when caller transfer nep-5 asset.
public static event transfer(byte[] from, byte[] to, BigInteger amount)'>Copy</button><pre><code class='csharp' lang='csharp'>//Should be called when caller transfer nep-5 asset.
public static event transfer(byte[] from, byte[] to, BigInteger amount)
</code></pre>
</figure>
<h2 id='ab22bb13'><span class='with-space bd-content-title'>Assignment<a class='anchorjs-link ' href='#ab22bb13' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>In the above <code>DNS</code> smart contract, there is a delete method. The general idea is  check the owner first and if it exists and it is the same as the one who invoke the contract, delete the pair using the <code>Storage.Delete</code> method. Please finish this function.</p>
<h2 id='a11f4a0e'><span class='with-space bd-content-title'>Next step<a class='anchorjs-link ' href='#a11f4a0e' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Great! Your just finished your first smart contract. Now let us move on to the <a href='What_is_nep5.html'> NEP 5 Token</a> </p>
<p class='with-space'>If you are not familiar with how to compile and deploy the smart contract, you may first click <a href='Development_compile.html'> here</a> .</p>
            </main>
            <div class="d-none d-lg-block side-nav py-2 py-md-5">
                <a href="https://github.com/neo-project/docs/blob/master/tutorial/en-us/9-smartContract\Smart_Contract_basics.md" class="contribution-link d-block">Improve this Doc</a>
                <div class="side-nav-text">In this article</div>
                <div id="navbar-sidenav">
                    <nav class='nav nav-pills flex-column'>
<a class='ml--2 d-none my-1 nav-link' href='#bb8d469d'>NEO Smart contract 101</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-0 my-1 nav-link' href='#e7000242'>Contract structure</a>
<a class='ml-0 my-1 nav-link' href='#e8769108'>Constract property</a>
<a class='ml-0 my-1 nav-link' href='#cc6f7dc0'>Storage property</a>
<a class='ml-0 my-1 nav-link' href='#d73695be'>Data type</a>
<a class='ml-0 my-1 nav-link' href='#cc473b59'>Your first NEO contract</a>
<a class='ml-0 my-1 nav-link' href='#d1890376'>Main method</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-2 my-1 nav-link' href='#d7a7dc09'>Trigger</a>
<a class='ml-2 my-1 nav-link' href='#efc9fc03'>Verification trigger</a>
<a class='ml-2 my-1 nav-link' href='#ee1a28a3'>Application trigger</a>
</nav>
<a class='ml-0 my-1 nav-link' href='#eb6c173f'>CheckWitness</a>
<a class='ml-0 my-1 nav-link' href='#c97533b6'>Events</a>
<a class='ml-0 my-1 nav-link' href='#ab22bb13'>Assignment</a>
<a class='ml-0 my-1 nav-link' href='#a11f4a0e'>Next step</a>
</nav>
</nav>
                </div>
            </div>
        </div>
    </div>
    <div class="lightbulb" title="Turn On/Off" onclick="turnOff()">
        <i class="far fa-lightbulb"></i>
    </div>
    <footer>
        <div class="d-flex justify-content-between py-1 px-3 px-sm-4 px-md-5">
            <ul class="d-none d-md-block">
                <li><a href="https://github.com/neo-project/docs" title="GitHub" target="_blank">GitHub</a></li>
                <li><a href="https://github.com/neo-project/docs/issues" title="Issue" target="_blank">Issue</a></li>
                <li><a href="https://discord.io/neo" title="Discord" target="_blank">Discord</a></li>
            </ul>
            <p>Build by <a href="https://github.com/chenzhitong/NeoDocsBuilder" title="NeoDocsBuilder" target="_blank">NeoDocsBuilder</a></p>
            <p>Licensed under <a href="https://github.com/neo-project/docs/blob/master/LICENSE" title="CC-BY-4.0" target="_blank">CC-BY-4.0</a> license. </p>
        </div>
    </footer>
    <script src="https://neo-cdn.azureedge.net/lib/jquery/jquery.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/popper.js/popper.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/jquery.lazyload.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/text-autospace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130525731-2"></script>
    <script src="/js/site.min.js"></script>
    <script>
        //适用于FAQ的根据标题展开收缩
        if (false) {
            $("h2").click(function (e) {
                $(".div-collapse").not($(e.target).parents("h2").next()).hide("fast");
                $(e.target).parents("h2").next().toggle("fast");
            });
        }
    </script>
</body>
</html>
