<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="robots" content="index,follow">
    <meta name="author" content="neo-project">
    <meta name="application-name" content="neo.org">
    <meta name="renderer" content="ie-stand">
    <title>Consensus Protocol</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Neo Documentation" />
    <meta property="og:description" content="Neo Documentation" />
    <meta property="og:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:title" content="Neo Documentation" />
    <meta name="twitter:description" content="Neo Documentation" />
    <meta name="twitter:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:card" content="summary_large_image" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/site.webmanifest">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link href="https://neo-cdn.azureedge.net/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://neo-cdn.azureedge.net/lib/animate.css/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
    <link href="/lib/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="/css/site.min.css" rel="stylesheet" />
</head>
<body data-spy="scroll" data-target="#navbar-sidenav">
    <nav class="navbar fixed-top navbar-expand-lg py-1 px-3 px-sm-4 px-md-5">
        <a class="navbar-brand" href="https://neo.org">
            <img class="logo" src="/img/logo.svg" alt="NEO Logo" />
            <img class="logo-dark" src="/img/logo-dark.svg" alt="NEO Logo" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/docs">Documentation</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/tutorial">Tutorial</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/faq">FAQ</a>
                </li>
                <li class="nav-item" style="margin-right: 100px">
                    <a class="nav-link" href="/articles">Articles</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link d-inline-block" href="javascript:" onclick="language('en-us')">EN</a>|<a class="nav-link d-inline-block" href="javascript:" onclick="language('zh-cn')">中文</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0 d-none">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>
    <div class="container-fluid" style="margin-top: 55px">
        <div class="row d-flex">
            <div class="d-none d-md-block catalog py-2 py-md-5 pl-md-3">
                
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/index.html'>Site Map</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO Introduction</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/basic/whitepaper.html'>NEO Whitepaper</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO Technology</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/basic/technology/neovm.html'>NeoVM</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/basic/technology/neocontract.html'>NEO Contract</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/basic/technology/dbft.html'>Consensus Mechanism</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO Node</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/introduction.html'>Introduction</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO-GUI</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/install.html'>Installing the Client</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/wallet.html'>Wallet</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/transc.html'>Transactions</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/asset.html'>Registering and Distributing Assets</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/sc.html'>Interacting with Smart Contracts</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/vote.html'>Election and Voting</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/gui/other.html'>Other Features</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO-CLI</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/cli/publish.html'>Publishing from Source</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/cli/setup.html'>Installation</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/cli/seedlist.html'>SeedList</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/node/cli/cli.html'>Command Line</a>
</nav>
<a class='ml-0 my-1 nav-link' href='/docs/zh-cn/node/syncblocks.html'>Synchronizing the blockchain faster</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO Network</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/network/testnet.html'>Main Net and Test Net</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Setting up Private Chain</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/network/private-chain/solo.html'>Solo Mode</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/network/private-chain/private-chain.html'>Multiple Nodes (virtual machines)</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/network/private-chain/private-chain2.html'>Multiple Nodes (local host)</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/network/private-chain/neolocal.html'>Neo-local</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Smart Contract Development</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Getting Started (C#)</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/gettingstarted/introduction.html'>Introduction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/gettingstarted/prerequisites.html'>Before You Begin</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/gettingstarted/enviroment.html'>Setting up local network</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/gettingstarted/develop.html'>Compiling a Contract Sample</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/gettingstarted/deploy.html'>Deploying and Invoking the Contract</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Development Environment</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/devenv/getting-started-csharp-mac.html'>Using C# on macOS</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/devenv/getting-started-csharp-ubuntu.html'>Using C# on ubuntu</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/devenv/getting-started-java.html'>Using Java</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/devenv/getting-started-python.html'>Using Python</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Writing smart contracts</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/write/basics.html'>Basics</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/write/limitation.html'>Limitations</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/write/nep5.html'>NEP-5</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Deploying and Invoking Smart Contracts</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/deploy/deploy.html'>Deploying Smart Contracts</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/deploy/invoke.html'>Invoking Smart Contracts</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/deploy/Parameter.html'>Parameters and Return Values</a>
</nav>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/test.html'>Testing</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/migrate.html'>Contract Migration and Destruction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/fees.html'>Fees</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Contract Samples</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/sample/HelloWorld.html'>Hello World</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/sample/Domain.html'>Domain</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/sample/verify.html'>Verification Contract</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/sc/sample/Lock2.html'>Lock Contract</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO Tools Development</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Main Concepts</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Blockchain Models</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/blockchain/block.html'>Block</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/blockchain/token_model.html'>Tokens</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/blockchain/utxo.html'>UTXO</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/blockchain/account_asset.html'>Account and Asset</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/blockchain/validator.html'>Validator</a>
</nav>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/charging_model.html'>Charging Model</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/transaction.html'>Transaction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/wallets.html'>Wallet</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Consensus</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/consensus/consensus_algorithm.html'>Consensus Algorithm</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/consensus/consensus_protocol.html'>Consensus Protocol</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/consensus/vote_validator.html'>Vote</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Cryptography</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/cryptography/encode_algorithm.html'>Encode Algorithm</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/cryptography/hash_algorithm.html'>Hash Algorithm</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/concept/cryptography/encryption_algorithm.html'>Encryption Algorithm</a>
</nav>
</nav>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/neo_cli_structure.html'>NEO-CLI Structure</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO SDK</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/sdk/introduction.html'>About NEO SDK</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/sdk/conversion.html'>Data Conversion</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/sdk/account.html'>Account</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/sdk/wallet.html'>Wallet</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/sdk/tx.html'>Transaction Construction</a>
</nav>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/endian.html'>Big and Little Endian Usage</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Advanced Topics</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/advanced/neo_vm.html'>NeoVM Instructions</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/advanced/network-protocol.html'>Network Protocol</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/advanced/tx_execution.html'>Transaction Process</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/tooldev/advanced/merkle_tree.html'>Merkel Tree</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Document for Exchange Developers</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/exchange/general.html'>Overview</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>v2.10.3</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/exchange/2.10.3/deploynode.html'>Deploying NEO nodes</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/exchange/2.10.3/client.html'>Using NEO-CLI</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/exchange/2.10.3/transaction.html'>Dealing with assets transactions</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/exchange/2.10.3/gas.html'>Distributing GAS to users</a>
</nav>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/exchange/changelog.html'>Changelog</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Reference</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>RPC API</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api.html'>API Reference</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>v2.10.3</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/claimgas.html'>claimgas</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/dumpprivkey.html'>dumpprivkey</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getaccountstate.html'>getaccountstate</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getapplicationlog.html'>getapplicationlog</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getassetstate.html'>getassetstate</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getbalance.html'>getbalance</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getbestblockhash.html'>getbestblockhash</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getblock.html'>getblock</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getblock2.html'>getblock</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getblockcount.html'>getblockcount</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getblockheader.html'>getblockheader</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getblockhash.html'>getblockhash</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getblocksysfee.html'>getblocksysfee</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getclaimable.html'>getclaimable</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getconnectioncount.html'>getconnectioncount</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getcontractstate.html'>getcontractstate</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getmetricblocktimestamp.html'>getmetricblocktimestamp</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getnep5balances.html'>getnep5balances</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getnep5transfers.html'>getnep5transfers</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getnewaddress.html'>getnewaddress</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getrawmempool.html'>getrawmempool</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getrawtransaction.html'>getrawtransaction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getstorage.html'>getstorage</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/gettransactionheight.html'>gettransactionheight</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/gettxout.html'>gettxout</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getpeers.html'>getpeers</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getunclaimedgas.html'>getunclaimedgas</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getunclaimed.html'>getunclaimed</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getunspents.html'>getunspents</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getvalidators.html'>getvalidators</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getversion.html'>getversion</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/getwalletheight.html'>getwalletheight</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/importprivkey.html'>importprivkey</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/invokefunction.html'>invokefunction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/invokescript.html'>invokescript</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/listplugins.html'>listplugins</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/listaddress.html'>listaddress</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/sendfrom.html'>sendfrom</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/sendrawtransaction.html'>sendrawtransaction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/sendtoaddress.html'>sendtoaddress</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/sendmany.html'>sendmany</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/submitblock.html'>submitblock</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/rpc/latest-version/api/validateaddress.html'>validateaddress</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Smart Contract API</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>API Reference</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/api/neo.html'>NEO</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/api/System.html'>System</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>Framework</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>.net Framework</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>NEO</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Account.html'>Account</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Asset.html'>Asset</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Block.html'>Block</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Blockchain.html'>Blockchain</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Contract.html'>Contract</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Enrollment.html'>Enrollment</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Header.html'>Header</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Runtime.html'>Runtime</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Storage.html'>Storage</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/StorageContext.html'>StorageContext</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Transaction.html'>Transaction</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/TransactionAttribute.html'>TransactionAttribute</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/TransactionInput.html'>TransactionInput</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/TransactionOutput.html'>TransactionOutput</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/TriggerType.html'>TriggerType</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/neo/Validator.html'>Validator</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>System</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/reference/scapi/fw/dotnet/System/ExecutionEngine.html'>ExecutionEngine</a>
</nav>
</nav>
</nav>
</nav>
<a class='ml-0 my-1 nav-link' href='https'>SDK API (C#)</a>
</nav>
</nav>
            </div>
            <main class="p-3 p-sm-4 p-md-5">
                <a class="d-block d-md-none" href="javascript:" onclick="showCatalog()">Show / Hide Table of Contents</a>
                <h1 id='e5c29244'><span class='with-space bd-content-title'>Consensus Protocol<a class='anchorjs-link ' href='#e5c29244' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h1>
<h2 id='eae50e15'><span class='with-space bd-content-title'>Consensus Message Format<a class='anchorjs-link ' href='#eae50e15' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<h3 id='dceb59f8'><span class='with-space bd-content-title'>P2P message format<a class='anchorjs-link ' href='#dceb59f8' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>4</td><td>Magic</td><td>uint</td><td>Protocol ID, defined in the configuration file <code>protocol.json</code> , mainnet is <code>7630401</code> , testnet is <code>1953787457</code> </td></tr><tr><td>12</td><td>Command</td><td>string</td><td>Command, all consensus messages&#39; command is <code>consensus</code> </td></tr><tr><td>4</td><td>Length</td><td>uint32</td><td>Length of payload</td></tr><tr><td>4</td><td>Checksum</td><td>uint</td><td>Checksum</td></tr><tr><td>Length</td><td>Payload</td><td>byte[]</td><td>Content of message, all consensus messages&#39; payload is <code>ConsensusPayload</code> </td></tr>
</tbody>
</table></figure>
<h3 id='f0f644c6'><span class='with-space bd-content-title'>ConsensusPayload<a class='anchorjs-link ' href='#f0f644c6' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>4</td><td>Version</td><td>uint</td><td>Version of protocol, 0 for now</td></tr><tr><td>32</td><td>PrevHash</td><td>UInt256</td><td>Previous block&#39;s hash</td></tr><tr><td>4</td><td>BlockIndex</td><td>uint</td><td>Height of the block</td></tr><tr><td>2</td><td>ValidatorIndex</td><td>ushort</td><td>The index of the current consensus node in validators array</td></tr><tr><td>4</td><td>Timestamp</td><td>uint</td><td>Timestamp</td></tr><tr><td>?</td><td>Data</td><td>byte[]</td><td>Includes <code>ChangeView</code> , <code>PrepareRequest</code> and <code>PrepareResponse</code> </td></tr><tr><td>1</td><td>-</td><td>uint8</td><td>It&#39;s fixed to 1</td></tr><tr><td>?</td><td>Witness</td><td>Witness</td><td>Witness contains invocation script and verificatioin script</td></tr>
</tbody>
</table></figure>
<h3 id='d2f8de00'><span class='with-space bd-content-title'>ChangeView<a class='anchorjs-link ' href='#d2f8de00' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>1</td><td>Type</td><td>ConsensusMessageType</td><td> <code>0x00</code> </td></tr><tr><td>1</td><td>ViewNumber</td><td>byte</td><td>Current view number</td></tr><tr><td>1</td><td>NewViewNumber</td><td>byte</td><td>New view number</td></tr>
</tbody>
</table></figure>
<h3 id='fc0e8f30'><span class='with-space bd-content-title'>PrepareRequest<a class='anchorjs-link ' href='#fc0e8f30' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>1</td><td>Type</td><td>ConsensusMessageType</td><td> <code>0x20</code> </td></tr><tr><td>1</td><td>ViewNumber</td><td>byte</td><td>Current view number</td></tr><tr><td>8</td><td>Nonce</td><td>ulong</td><td>block nonce</td></tr><tr><td>20</td><td>NextConsensus</td><td>UInt160</td><td>The script hash of the next round consensus nodes&#39; multi-signature contract</td></tr><tr><td>4 + 32 * length</td><td>TransactionHashes</td><td>UInt256[]</td><td>The proposal block&#39;s transaction hashes</td></tr><tr><td>78</td><td>MinerTransaction</td><td>MinerTransaction</td><td>It is used to sum all the transaction fees of the current block as a reward for the speaker.</td></tr><tr><td>64</td><td>Signature</td><td>byte[]</td><td>Block signature</td></tr>
</tbody>
</table></figure>
<h3 id='bd2194ea'><span class='with-space bd-content-title'>PrepareResponse<a class='anchorjs-link ' href='#bd2194ea' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>1</td><td>Type</td><td>ConsensusMessageType</td><td> <code>0x21</code> </td></tr><tr><td>1</td><td>ViewNumber</td><td>byte</td><td>Current view number</td></tr><tr><td>64</td><td>Signature</td><td>byte[]</td><td>Block signature</td></tr>
</tbody>
</table></figure>
<h2 id='a306df2e'><span class='with-space bd-content-title'>Transport Protocol<a class='anchorjs-link ' href='#a306df2e' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>When a consensus message enters the P2P network, it&#39;s broadcasted and transmitted like other messages. That is because consensus nodes do not have IP address of other consensus nodes. Consensus nodes are not directly connected. That is to say, ordinary nodes can also receive consensus message. The broadcast flow of consensus messages is as follows.</p>
<p class='with-space'> <a href='../../images/consensus/consensus_msg_seq.jpg'> <img class='d-inline-block img-fluid' data-original='../../images/consensus/consensus_msg_seq.jpg' alt='consensus_msg_seq' referrerPolicy='no-referrer' /></a> </p>
<ol>
<li>
<p class='with-space'>Consensus node A will directly broadcast &#39;consensus&#39; message to connected nodes(e.g. node B).</p></li>
<li>
<p class='with-space'>After receiving the <code>consensus</code> message, node B firstly process the received consensus message and then forwards it. Before forwarding the consensus message, it sends an <code>inv</code> message which carries the hash data of the <code>payload</code> of the <code>consensus</code> message (to node C).</p></li>
<li>
<p class='with-space'>If the node C has already known the data corresponding to the hash, it does not process the inv message. Otherwise, it proceeds to step 4.</p></li>
<li>
<p class='with-space'>Node C sends a <code>getdata</code> message to node B, with the hash data in the <code>inv</code> message.</p></li>
<li>
<p class='with-space'>After receiving the <code>getdata</code> message, node B sends a <code>consensus</code> message to node C.</p></li>
<li>
<p class='with-space'>After receiving the <code>consensus</code> message, the node C triggers the consensus module to process the message, and forwards the consensus message, and then returns to step 2.</p></li>
</ol>
<h3 id='e3268ac3'><span class='with-space bd-content-title'>inv message format<a class='anchorjs-link ' href='#e3268ac3' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>4</td><td>Magic</td><td>uint</td><td>Protocol ID</td></tr><tr><td>12</td><td>Command</td><td>string</td><td> <code>inv</code> </td></tr><tr><td>4</td><td>Length</td><td>uint32</td><td>Length of payload</td></tr><tr><td>4</td><td>Checksum</td><td>uint</td><td>Checksum</td></tr><tr><td>Length</td><td>Payload</td><td>byte[]</td><td>Format: <code>0xe0</code> + <code>0x00000001</code> + <code>ConsensusPayload.Hash</code> </td></tr>
</tbody>
</table></figure>
<blockquote class='bd-callout bd-callout-info with-space'>
<p class='with-space'>Payload&#39;s format： <code>inv.type + inv.payloads.length + inv.payload</code>  <code>inv</code> message&#39;s payload has three types listed as follow:</p>
<ul class='with-space'>
<li>
<p class='with-space'> <code>0x01</code> : Transaction. <code>inv.payload</code> is assigned to transaction&#39;s hash.</p></li>
<li>
<p class='with-space'> <code>0x02</code> : Block. <code>inv.payload</code> is assigned to <code>ConsensusPayload</code> message&#39;s hash.</p></li>
<li>
<p class='with-space'> <code>0xe0</code> : Consensus. <code>inv.payload</code> is assigned to block&#39;s hash.</p></li>
</ul>
</blockquote>
<h3 id='db6f8ae6'><span class='with-space bd-content-title'>getdata message format<a class='anchorjs-link ' href='#db6f8ae6' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<figure class='with-space'><table class='table table-hover'>
<thead><tr><th>Size</th><th>Field</th><th>Type</th><th>Description</th></tr></thead>
<tbody><tr><td>4</td><td>Magic</td><td>uint</td><td>Protocol ID</td></tr><tr><td>12</td><td>Command</td><td>string</td><td> <code>getdata</code> </td></tr><tr><td>4</td><td>Length</td><td>uint32</td><td>Length of payload</td></tr><tr><td>4</td><td>Checksum</td><td>uint</td><td>Checksum</td></tr><tr><td>Length</td><td>Payload</td><td>byte[]</td><td>Format: <code>0xe0</code> + <code>0x00000001</code> + <code>ConsensusPayload.Hash</code> </td></tr>
</tbody>
</table></figure>
<blockquote class='bd-callout bd-callout-info with-space'>
<p class='with-space'>The <code>getdata</code> message is mainly used to get the specific content in <code>inv</code> message.</p>
</blockquote>
<h2 id='cce8ebe7'><span class='with-space bd-content-title'>Consensus Message Process<a class='anchorjs-link ' href='#cce8ebe7' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<h3 id='e2a12ef9'><span class='with-space bd-content-title'>Verification<a class='anchorjs-link ' href='#e2a12ef9' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<ol>
<li>
<p class='with-space'>Ignore the message if the <code>ConsensusPayload.BlockIndex</code> is lower than current block height.</p></li>
<li>
<p class='with-space'>Ignore the message if the verification script failed or the script hash does not equal to <code>ConsensusPayload.ValidatorIndex</code> address&#39;s script hash.</p></li>
<li>
<p class='with-space'>Ignore the message if the <code>ConsensusPayload.ValidatorIndex</code> equals to current node index.</p></li>
<li>
<p class='with-space'>Ignore the message if the <code>ConsensusPayload.Version</code> does not equal to current consensus version.</p></li>
<li>
<p class='with-space'>Ignore the message if the <code>ConsensusPayload.PrevHash</code> and <code>ConsensusPayload.BlockIndex</code> do not equal to the values in current node&#39;s context.</p></li>
<li>
<p class='with-space'>Ignore the message if the <code>ConsensusPayload.ValidatorIndex</code> is out of index of the current consensus nodes array.</p></li>
<li>
<p class='with-space'>Ignore the message if the <code>ConsensusMessage.ViewNumber</code> does not equal to the value in current node&#39;s context except that the consensus message is a <code>ChangeView</code> .</p></li>
</ol>
<h3 id='a6061e3d'><span class='with-space bd-content-title'>Process<a class='anchorjs-link ' href='#a6061e3d' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<ol>
<li>
<p class='with-space'>On receiving a <strong>PrepareRequest</strong> sent by speaker, attached with proposal block data.</p>
<ol>
<li>
<p class='with-space'>Ignore if the <code>PrepareRequest</code> has already been received.</p></li>
<li>
<p class='with-space'>Ignore if the <code>ConsensusPayload.ValidatorIndex</code> is not the index of the current round speaker.</p></li>
<li>
<p class='with-space'>Ignore if the <code>ConsensusPayload.Timestamp</code> is not more than the timestamp of the previous block, or is more than 10 minutes above current time.</p></li>
<li>
<p class='with-space'>Ignore if the signature of the message is incorrect.</p></li>
<li>
<p class='with-space'>Clear signatures saved in the context that does not match the received proposal message.</p></li>
<li>
<p class='with-space'>Save the signature of the speaker into current context.</p></li>
<li>
<p class='with-space'>Collect and verify transactions in the proposal block from memory pool.</p></li>
<li>
<p class='with-space'>If the transaction failed to pass verification or policy check provided by plugin, it will stop the process and request ChangeView.</p></li>
<li>
<p class='with-space'>Otherwise the transaction will be saved into current context.</p></li>
<li>
<p class='with-space'>If all the transactions in the proposal block are collected, broadcast <code>PrepareResponse</code> message.</p></li>
<li>
<p class='with-space'>Collect and verify transactions in the proposal block from unverified memory pool.</p></li>
<li>
<p class='with-space'>Verify the MinerTransaction and add it into current context.</p></li>
<li>
<p class='with-space'>If all transactions are collected verified, it will request PrepareResponse. Otherwise it will broadcast a getdata message to retrieve transactions from other nodes.</p></li>
</ol></li>
<li>
<p class='with-space'>On receiving a <strong>PrepareResponse</strong> sent by consensus nodes with their signture.</p>
<ol>
<li>
<p class='with-space'>Ignore it if current node has already saved the sender&#39;s signature.</p></li>
<li>
<p class='with-space'>Save it temporarily if current node does not have information of corresponding PrepareRequest of the received PrepareResponse yet.</p></li>
<li>
<p class='with-space'>Otherwise verify the signature. Save the signature if it pass the verification. Ignore it if not.</p></li>
<li>
<p class='with-space'>If there are at least <code>N-f</code> signatures, accept the new block and broadcast it.</p></li>
</ol></li>
<li>
<p class='with-space'>On receiving a <strong>Changeview</strong> sent by consensus nodes.</p>
<ol>
<li>
<p class='with-space'>Ignore it if the view number in the message is less than the view number in current context.</p></li>
<li>
<p class='with-space'>If current node received at least <code>N-f</code>  <code>ChangeView</code> messages with the same new view number, then ViewChange will happen. The current node reset the consensus process with the new view number.</p></li>
</ol></li>
<li>
<p class='with-space'>On <strong>Timeout</strong> happens</p>
<ol>
<li>
<p class='with-space'>If the process above timeout, the consensus node will broadcast <code>ChangeView</code> message directly.</p></li>
<li>
<p class='with-space'>Timeout time starts from 30 seconds. Timeout interval doubles when each timeout happens.</p></li>
</ol></li>
<li>
<p class='with-space'>On receiving a <strong>New Block</strong> </p>
<ol>
<li>
<p class='with-space'>resetting consensus process</p></li>
</ol></li>
<li>
<p class='with-space'>On receiving a <strong>New Transaction</strong> for consensus</p>
<ol>
<li>
<p class='with-space'>Ignore if the transaction is a <code>MinerTransaction</code> . (A <code>MinerTransaction</code> should not be broadcasted).</p></li>
<li>
<p class='with-space'>Ignore if current node is speaker, or the node has sent <code>PrepareRequest</code> or <code>PrepareResponse</code> message, or in process of change view.</p></li>
<li>
<p class='with-space'>Ignore if the transaction has been received before.</p></li>
<li>
<p class='with-space'>Ignore if the received transacion isn&#39;t in the propoal block.</p></li>
<li>
<p class='with-space'>Save the transaction into current context.</p></li>
</ol></li>
</ol>
            </main>
            <div class="d-none d-lg-block side-nav py-2 py-md-5">
                <a href="https://github.com/neo-project/docs/blob/master/docs/en-us/tooldev\concept\consensus\consensus_protocol.md" class="contribution-link d-block">Improve this Doc</a>
                <div class="side-nav-text">In this article</div>
                <div id="navbar-sidenav">
                    <nav class='nav nav-pills flex-column'>
<a class='ml--2 d-none my-1 nav-link' href='#e5c29244'>Consensus Protocol</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-0 my-1 nav-link' href='#eae50e15'>Consensus Message Format</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-2 my-1 nav-link' href='#dceb59f8'>P2P message format</a>
<a class='ml-2 my-1 nav-link' href='#f0f644c6'>ConsensusPayload</a>
<a class='ml-2 my-1 nav-link' href='#d2f8de00'>ChangeView</a>
<a class='ml-2 my-1 nav-link' href='#fc0e8f30'>PrepareRequest</a>
<a class='ml-2 my-1 nav-link' href='#bd2194ea'>PrepareResponse</a>
</nav>
<a class='ml-0 my-1 nav-link' href='#a306df2e'>Transport Protocol</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-2 my-1 nav-link' href='#e3268ac3'>inv message format</a>
<a class='ml-2 my-1 nav-link' href='#db6f8ae6'>getdata message format</a>
</nav>
<a class='ml-0 my-1 nav-link' href='#cce8ebe7'>Consensus Message Process</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-2 my-1 nav-link' href='#e2a12ef9'>Verification</a>
<a class='ml-2 my-1 nav-link' href='#a6061e3d'>Process</a>
</nav>
</nav>
</nav>
                </div>
            </div>
        </div>
    </div>
    <div class="lightbulb" title="Turn On/Off" onclick="turnOff()">
        <i class="far fa-lightbulb"></i>
    </div>
    <footer>
        <div class="d-flex justify-content-between py-1 px-3 px-sm-4 px-md-5">
            <ul class="d-none d-md-block">
                <li><a href="https://github.com/neo-project/docs" title="GitHub" target="_blank">GitHub</a></li>
                <li><a href="https://github.com/neo-project/docs/issues" title="Issue" target="_blank">Issue</a></li>
                <li><a href="https://discord.io/neo" title="Discord" target="_blank">Discord</a></li>
            </ul>
            <p>Build by <a href="https://github.com/chenzhitong/NeoDocsBuilder" title="NeoDocsBuilder" target="_blank">NeoDocsBuilder</a></p>
            <p>Licensed under <a href="https://github.com/neo-project/docs/blob/master/LICENSE" title="CC-BY-4.0" target="_blank">CC-BY-4.0</a> license. </p>
        </div>
    </footer>
    <script src="https://neo-cdn.azureedge.net/lib/jquery/jquery.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/popper.js/popper.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/jquery.lazyload.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/text-autospace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130525731-2"></script>
    <script src="/js/site.min.js"></script>
    <script>
        //适用于FAQ的根据标题展开收缩
        if (false) {
            $("h2").click(function (e) {
                $(".div-collapse").not($(e.target).parents("h2").next()).hide("fast");
                $(e.target).parents("h2").next().toggle("fast");
            });
        }
    </script>
</body>
</html>
