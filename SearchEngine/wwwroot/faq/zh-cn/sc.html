<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="robots" content="index,follow">
    <meta name="author" content="neo-project">
    <meta name="application-name" content="neo.org">
    <meta name="renderer" content="ie-stand">
    <title>智能合约</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Neo Documentation" />
    <meta property="og:description" content="Neo Documentation" />
    <meta property="og:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:title" content="Neo Documentation" />
    <meta name="twitter:description" content="Neo Documentation" />
    <meta name="twitter:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:card" content="summary_large_image" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/site.webmanifest">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link href="https://neo-cdn.azureedge.net/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://neo-cdn.azureedge.net/lib/animate.css/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
    <link href="/lib/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="/css/site.min.css" rel="stylesheet" />
</head>
<body data-spy="scroll" data-target="#navbar-sidenav">
    <nav class="navbar fixed-top navbar-expand-lg py-1 px-3 px-sm-4 px-md-5">
        <a class="navbar-brand" href="https://neo.org">
            <img class="logo" src="/img/logo.svg" alt="NEO Logo" />
            <img class="logo-dark" src="/img/logo-dark.svg" alt="NEO Logo" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/docs">Documentation</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/tutorial">Tutorial</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/faq">FAQ</a>
                </li>
                <li class="nav-item" style="margin-right: 100px">
                    <a class="nav-link" href="/articles">Articles</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link d-inline-block" href="javascript:" onclick="language('en-us')">EN</a>|<a class="nav-link d-inline-block" href="javascript:" onclick="language('zh-cn')">中文</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0 d-none">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>
    <div class="container-fluid" style="margin-top: 55px">
        <div class="row d-flex">
            <div class="d-none d-md-block catalog py-2 py-md-5 pl-md-3">
                
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/faq/zh-cn/basic.html'>一般问题</a>
<a class='ml-0 my-1 nav-link' href='/faq/zh-cn/client.html'>客户端与钱包</a>
<a class='ml-0 my-1 nav-link' href='/faq/zh-cn/dev.html'>开发相关</a>
<a class='ml-0 my-1 nav-link' href='/faq/zh-cn/sc.html'>智能合约</a>
</nav>
            </div>
            <main class="p-3 p-sm-4 p-md-5">
                <a class="d-block d-md-none" href="javascript:" onclick="showCatalog()">Show / Hide Table of Contents</a>
                <h1 id='de2e3548'><span class='with-space bd-content-title'>智能合约<a class='anchorjs-link ' href='#de2e3548' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h1>
<h2 id='c79e6515' class='h2-collapse'><span class='with-space bd-content-title'>为什么我发布 neon 时提示无法还原 NuGet 包？即使我尝试使用 Visual Studio 2017 进行还原，仍然会出现同样的错误。<a class='anchorjs-link ' href='#c79e6515' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>可根据以下步骤解决该问题：</p>
<ol>
<li>
<p class='with-space'>在 <a href='https://www.nuget.org/downloads' target='_blank'> 这里</a> 下载 nuget.exe，然后将其复制到 neo-compiler 项目的根目录。</p></li>
<li>
<p class='with-space'>打开 Power Shell 或命令提示符（CMD）。</p></li>
<li>
<p class='with-space'>转到 neo-compiler 根目录，运行 <code>nuget restore</code> 。</p></li>
</ol></div>
<h2 id='bd6e3922' class='h2-collapse'><span class='with-space bd-content-title'>为什么我发布C#智能合约编译器失败？<a class='anchorjs-link ' href='#bd6e3922' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>在发布C#智能合约编译器之前，请确认你进行了以下操作：</p>
<ul class='with-space'>
<li>
<p class='with-space'>已安装最新 .net core 2.1版本；</p></li>
<li>
<p class='with-space'>使用 VS2017 发布时，选择目标为 win10-64;</p></li>
<li>
<p class='with-space'>使用 VS2019 发布时，修改目标为 win10-64，并选择 “独立” 部署模式</p></li>
</ul></div>
<h2 id='eec3e151' class='h2-collapse'><span class='with-space bd-content-title'>为什么我发布 neon 项目出现如下错误提示：无法复制文件”obj\Release\netcoreapp1.0\win10-x64\neon.dll“，原因是找不到该文件？<a class='anchorjs-link ' href='#eec3e151' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>这可能是 VS 2017 （如 15.4，15.5）的一个 Bug，此时需要手动将 <code>\obj\Release\netcoreapp1.0\neon.dll</code> 文件复制到 <code>\obj\Release\netcoreapp1.0\win10-x64\</code> 文件夹中，然后重新发布即可。</p></div>
<h2 id='cec13786' class='h2-collapse'><span class='with-space bd-content-title'>为什么我创建 NeoContract 项目后, 代码中有很多画红线的地方，提示找不到 Neo 命名空间，而且在项目的引用中有感叹号？<a class='anchorjs-link ' href='#cec13786' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>在 VS 中右击解决方案文件，点击 <code>还原 NuGet 程序 包</code> ，这时在 “输出” 面板会看到 “正在还原 NuGet 程序包...”。所有程序包已经还原成功后，如果代码仍然报错，并且右侧 “引用” 中仍有个感叹号，可以尝试双击感叹号。如果仍然无法解决问题，可以尝试下面的办法：</p>
<ol>
<li>
<p class='with-space'>在 <a href='https://www.nuget.org/downloads' target='_blank'> 这里</a> 下载 nuget.exe，然后将其复制到 NeoContract 项目的根目录。</p></li>
<li>
<p class='with-space'>打开 Power Shell 或命令提示符（CMD）。</p></li>
<li>
<p class='with-space'>转到 NeoContract 项目的根目录，运行 <code>nuget restore</code> 即可。</p></li>
</ol></div>
<h2 id='b4d9fed8' class='h2-collapse'><span class='with-space bd-content-title'>为什么当我在 Windows 7 中发布 neon 设置好环境变量后，运行 neon 时提示缺少  api-ms-win-core-console-l2-1-0.dll 文件？<a class='anchorjs-link ' href='#b4d9fed8' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>发布时的平台错了，neon 项目默认的发布平台为 win10-x64，所以发布到 Windows7 时才会提示缺少 dll 文件。这时，需要用文本编译器打开 neon.csproj 文件，将 <code>&lt;RuntimeIdentifiers&gt;win10-x64&lt;/RuntimeIdentifiers&gt;</code> 更改为 <code>&lt;RuntimeIdentifiers&gt;win7-64&lt;/RuntimeIdentifiers&gt;</code> 然后用 VS 重新发布该项目即可。或者可以直接用命令 <code>dotnet publish -r win7-x64 -c debug</code> 来发布。</p>
<p class='with-space'>详细 RID 可以参考 <a href='https://docs.microsoft.com/en-us/dotnet/core/rid-catalog' target='_blank'> .NET Core Runtime IDentifier (RID) catalog</a> 。</p></div>
<h2 id='f091ba12' class='h2-collapse'><span class='with-space bd-content-title'>为什么我设置好环境变量后，在 CMD 中输入 neon 却提示找不到 neon？<a class='anchorjs-link ' href='#f091ba12' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>这是因为修改环境变量后没有重新启动 CMD，CMD 读取的环境变量还是之前没有修改过的。解决办法：重启 CMD。</p></div>
<h2 id='ddcd6970' class='h2-collapse'><span class='with-space bd-content-title'>已经发布了 neon 并将 neon.exe 所在目录添加到了 path， 为什么编译 NeoContract 时卡在 Start NeoContract converter 这一步？<a class='anchorjs-link ' href='#ddcd6970' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>这是因为修改环境变量后没有重新启动 Visual Studio，Visual Studio 读取的环境变量还是之前没有修改过的，所以找不到 neon。</p>
<p class='with-space'>解决办法：重启 Visual Studio。如果仍未解决就重启系统。</p></div>
<h2 id='f3c78eee' class='h2-collapse'><span class='with-space bd-content-title'>我用旧版本的 neon 编译的智能合约，代码写的没有问题，为什么在测试网或主网上运行失败？<a class='anchorjs-link ' href='#f3c78eee' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>NEO 智能合约需要的 开发框架、编译器、NeoVM 版本要求一致。否则用旧版本的开发框架和编译器编译的代码有可能在新版 NeoVM 中运行出错。已发布到区块链上的智能合约不受此影响。</p>
<p class='with-space'>当你准备开始智能合约时，确保你的开发框架（如NeoContractPlugin）和编译器（如 neon）是最新版本。</p></div>
<h2 id='dcb1459a' class='h2-collapse'><span class='with-space bd-content-title'>为什么用 neoj 编译的时候出现错误提示：无法找到 org.neo.smartcontract.framework.jar?<a class='anchorjs-link ' href='#dcb1459a' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>你需要将 neo-devpack-java-master 打包成 jar 包并放入 neoj 的 \neoj\bin\Release\netcoreapp1.1\win10-x64\publish\</p>
<p class='with-space'>本节部分内容摘自文章： <a href='https://steemit.com/neo/@cybourgeoisie/neo-contract-development-common-pitfalls-using-windows-7' target='_blank'> NEO Contract Development - Common Pitfalls using Windows 7</a> 感谢 <strong>cybourgeoisie</strong> 的贡献。</p></div>
<h2 id='d73856e0' class='h2-collapse'><span class='with-space bd-content-title'>我成功部署了合约，为什么调用失败了？<a class='anchorjs-link ' href='#d73856e0' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<div class='div-collapse p-2 px-4'>
<p class='with-space'>这是因为合约使用新的NEP-8 opcodes进行编译，不兼容旧的NEOVM opcodes。要解决这个问题，需要在兼容模式下编译合约：</p>
<ol>
<li>
<p class='with-space'>发布 C# 编译器 neon.exe 添加其路径到环境变量</p></li>
<li>
<p class='with-space'>通过 Visual Studio 2017 编译并构建合约</p></li>
<li>
<p class='with-space'>在兼容模式下编译合约，使用命令： <code>neon contract.dll --compatible</code> </p></li>
<li>
<p class='with-space'>编译成功后使用新生成的合约文件部署合约</p></li>
</ol></div>
            </main>
            <div class="d-none d-lg-block side-nav py-2 py-md-5">
                <a href="https://github.com/neo-project/docs/blob/master/faq/zh-cn/sc.md" class="contribution-link d-block">Improve this Doc</a>
                <div class="side-nav-text">In this article</div>
                <div id="navbar-sidenav">
                    <nav class='nav nav-pills flex-column'>
<a class='ml--2 d-none my-1 nav-link' href='#de2e3548'>智能合约</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-0 my-1 nav-link' href='#c79e6515'>为什么我发布 neon 时提示无法还原 NuGet 包？即使我尝试使用 Visual Studio 2017 进行还原，仍然会出现同样的错误。</a>
<a class='ml-0 my-1 nav-link' href='#bd6e3922'>为什么我发布C#智能合约编译器失败？</a>
<a class='ml-0 my-1 nav-link' href='#eec3e151'>为什么我发布 neon 项目出现如下错误提示：无法复制文件”obj\Release\netcoreapp1.0\win10-x64\neon.dll“，原因是找不到该文件？</a>
<a class='ml-0 my-1 nav-link' href='#cec13786'>为什么我创建 NeoContract 项目后, 代码中有很多画红线的地方，提示找不到 Neo 命名空间，而且在项目的引用中有感叹号？</a>
<a class='ml-0 my-1 nav-link' href='#b4d9fed8'>为什么当我在 Windows 7 中发布 neon 设置好环境变量后，运行 neon 时提示缺少  api-ms-win-core-console-l2-1-0.dll 文件？</a>
<a class='ml-0 my-1 nav-link' href='#f091ba12'>为什么我设置好环境变量后，在 CMD 中输入 neon 却提示找不到 neon？</a>
<a class='ml-0 my-1 nav-link' href='#ddcd6970'>已经发布了 neon 并将 neon.exe 所在目录添加到了 path， 为什么编译 NeoContract 时卡在 Start NeoContract converter 这一步？</a>
<a class='ml-0 my-1 nav-link' href='#f3c78eee'>我用旧版本的 neon 编译的智能合约，代码写的没有问题，为什么在测试网或主网上运行失败？</a>
<a class='ml-0 my-1 nav-link' href='#dcb1459a'>为什么用 neoj 编译的时候出现错误提示：无法找到 org.neo.smartcontract.framework.jar?</a>
<a class='ml-0 my-1 nav-link' href='#d73856e0'>我成功部署了合约，为什么调用失败了？</a>
</nav>
</nav>
                </div>
            </div>
        </div>
    </div>
    <div class="lightbulb" title="Turn On/Off" onclick="turnOff()">
        <i class="far fa-lightbulb"></i>
    </div>
    <footer>
        <div class="d-flex justify-content-between py-1 px-3 px-sm-4 px-md-5">
            <ul class="d-none d-md-block">
                <li><a href="https://github.com/neo-project/docs" title="GitHub" target="_blank">GitHub</a></li>
                <li><a href="https://github.com/neo-project/docs/issues" title="Issue" target="_blank">Issue</a></li>
                <li><a href="https://discord.io/neo" title="Discord" target="_blank">Discord</a></li>
            </ul>
            <p>Build by <a href="https://github.com/chenzhitong/NeoDocsBuilder" title="NeoDocsBuilder" target="_blank">NeoDocsBuilder</a></p>
            <p>Licensed under <a href="https://github.com/neo-project/docs/blob/master/LICENSE" title="CC-BY-4.0" target="_blank">CC-BY-4.0</a> license. </p>
        </div>
    </footer>
    <script src="https://neo-cdn.azureedge.net/lib/jquery/jquery.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/popper.js/popper.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/jquery.lazyload.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
    <script src="https://neo-cdn.azureedge.net/js/text-autospace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130525731-2"></script>
    <script src="/js/site.min.js"></script>
    <script>
        //适用于FAQ的根据标题展开收缩
        if (true) {
            $("h2").click(function (e) {
                $(".div-collapse").not($(e.target).parents("h2").next()).hide("fast");
                $(e.target).parents("h2").next().toggle("fast");
            });
        }
    </script>
</body>
</html>
